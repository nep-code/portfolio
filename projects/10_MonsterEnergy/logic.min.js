var TX_Asset={INIT_IMAGES:[["#background","src/background.jpg"],["#logo","src/logo.png"],["#txt_tryitnow","src/txt_tryitnow.png"],["#txt_copy","src/txt_copy.png"],[".can_black","src/can_black.png"],[".can_white","src/can_white.png"],[".can_reveal","src/can_reveal.png"]],INIT_JS:["https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"]},TX_Button={MOUSECLICK:function(e){if(TX_Var.isButtonReady)switch(TX_API.CLICK_DELAY(.2),this.id){case"btn_tryitnow":window.open("https://www.monsterenergy.com/","_blank")}}},TX_Creative={INIT:function(){TX_Var.canvasHolder="#container #canvasHolder",TX_Var.can_container="#container #can_container",TX_Var.main_panel="#container #main_panel",TX_Var.can="#container #js-canvas",TX_Var.top_panel="#container #top_panel",TX_Var.can_white="#container .bg_cans .can_white",TX_Var.btn_tryitnow="#container #btn_tryitnow",TX_Var.txt_tryitnow="#container #txt_tryitnow",TX_Var.bg_tryitnow="#container #bg_tryitnow",TX_Var.videoplayed=0,TX_Var.idletimer=null,TX_Var.idle=!0,TX_Var.scratch=0,TX_Var.pulse_cta=gsap.timeline({repeat:-1,repeatDelay:6,overwrite:!0}),TX_Var.pulse_delay=null,TX_Creative.STEP_1()},STEP_1:function(){TX_Scratch.INIT(0),TX_Scratch.INIT(1),TX_Cursor.INIT(),TX_Video.INIT(),TX_Creative.init_pulse_cta(),TX_Var.idletimer=setTimeout(function(){gsap.fromTo(TX_Var.can_white,.6,{alpha:0},{alpha:1,repeat:-1,yoyo:!0,ease:"none"})},7e3),$("body").css("background-color","green")},STEP_2:function(e){TX_Var.videoplayed=1,console.log("STEP 2")},STEP_3:function(){},STEP_4:function(e){TX_Var.videoplayed=2,console.log("STEP 3")},STEP_5:function(){$(TX_Var.canvasHolder).hide(),$(TX_Var.main_panel).css({cursor:"auto"})},stop_idle:function(){TX_Var.idle=!1,clearTimeout(TX_Var.idletimer),gsap.to(TX_Var.can_white,.2,{alpha:0,repeat:0,yoyo:!1})},init_pulse_cta:function(e){TX_Var.pulse_cta.fromTo(TX_Var.bg_tryitnow,.5,{z:.01,scale:1,alpha:1},{z:.01,scaleX:1.15,scaleY:1.5,alpha:0},"pulse").to(TX_Var.txt_tryitnow,.2,{z:.01,scale:1.08,repeat:1,yoyo:!0},"pulse"),$(TX_Var.btn_tryitnow).on("mouseenter",function(){clearTimeout(TX_Var.pulse_delay),TX_Var.pulse_cta.pause(),gsap.to(TX_Var.bg_tryitnow,.2,{z:.01,scaleX:1.15,scaleY:1.5,alpha:0,overwrite:!0}),gsap.to(TX_Var.txt_tryitnow,.1,{z:.01,scale:1,overwrite:!0})}),$(TX_Var.btn_tryitnow).on("mouseleave",function(){TX_Var.pulse_delay=setTimeout(function(){TX_Var.pulse_cta.play(0)},6e3)})}},TX_Audio={ASSETS:[["SND_BGM",{src:"src/audio/bgm.mp3",loop:!0,volume:.5}],["SND_SCRATCH",{src:"src/audio/sfx_scratch.mp3",loop:!0,volume:0}]],ACTIVE_BUTTON:!0,INIT:function(e){if(img_audio=".img_audio",btn_audio="#btn_audio",$.getScript("https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js",TX_Audio.READY),TX_Audio.ACTIVE_BUTTON){let e="<div id='btn_audio' class='button'><div class='img_audio center'></div></div>";$("#container").append(e),$(img_audio).css({width:"30px",height:"30px",background:"url(src/spr_audio.png) no-repeat",transform:"scale(0.92) translateZ(0) scaleZ(2)"}),$(btn_audio).css({right:"8px",top:"17px",width:"45px",height:"45px"})}$(btn_audio).on("click",TX_Audio.MOUSECLICK),TX_Var.desktop&&$(btn_audio).hover(TX_Audio.MOUSEOVER,TX_Audio.MOUSEOUT)},READY:function(e){for(let e=0;e<TX_Audio.ASSETS.length;e++)TX_Audio.ASSETS[e][1].preload=!0,TX_Audio[TX_Audio.ASSETS[e][0]]=new Howl(TX_Audio.ASSETS[e][1]);TX_Audio.PLAY(TX_Audio.SND_BGM),TX_Audio.PLAY(TX_Audio.SND_SCRATCH),TX_Loader.IMAGE(TX_Asset.INIT_IMAGES),TX_Loader.JS(TX_Asset.INIT_JS)},MOUSECLICK:function(e){TX_Audio.ACTIVE?(TX_Audio.ACTIVE=!1,TX_Audio.VOLUME_OFF()):(TX_Audio.ACTIVE=!0,TX_Audio.VOLUME_ON())},MOUSEOVER:function(e){$(img_audio).css("transform","scale(1) translateZ(0) scaleZ(2)")},MOUSEOUT:function(e){$(img_audio).css("transform","scale(0.92) translateZ(0) scaleZ(2)")},PLAY:function(e){e.playing()?TX_Audio.SEEK(e,0):e.play()},PAUSE:function(e){e.pause()},STOP:function(e){e.stop()},MUTE:function(e){e.volume(0)},UNMUTE:function(e){e.volume(1)},SEEK:function(e,o){e.seek(o)},VOLUME_ON:function(){Howler.volume(1),$(".img_audio").css("background-position-y","0px")},VOLUME_OFF:function(){Howler.volume(0),$(".img_audio").css("background-position-y","-40px")},END:function(e){Howler.unload()},SCRATCHING:function(e){TX_Audio.UNMUTE(TX_Audio.SND_SCRATCH),TX_Var.endScratch=setTimeout(function(){TX_Audio.MUTE(TX_Audio.SND_SCRATCH)},500)},ACTIVE:!0},TX_Video={ASSETS:[["#vid_play","src/ico_play.png"],["#vid_replay","src/ico_replay.png"],["#vid_unmute","src/click_for_sound.png"],["#vid_unmute_mob","src/tap_for_sound.png"]],CONFIG:[{source:"src/video/Fiesta_Video.mp4",trackname:"Fiesta Video",preview:"src/video_prev0.jpg",endscreen:"src/video_prev0.jpg"},{source:"src/video/Rosa_Video.mp4",trackname:"Rosa Video",preview:"src/video_prev1.jpg",endscreen:"src/video_prev1.jpg"}],STYLE:{left:0,top:0,width:960,height:540,center:!0},INIT:function(){TX_Video.SETUP()},LOAD:function(e){TX_Video.CURRENT=e,TX_Video.DESTROY(),TX_Audio.MUTE(TX_Audio.SND_BGM),$(TX_Video.container).css({backgroundImage:"url("+TX_Video.CONFIG[TX_Video.CURRENT].preview+")",display:"block"}),$(TX_Video.content).on("play",TX_Video.START),$(TX_Video.content).on("ended",TX_Video.END),$(TX_Video.content).on("timeupdate",TX_Video.PROGRESS),$(TX_Video.content)[0].src=TX_Video.CONFIG[TX_Video.CURRENT].source;try{$(TX_Video.content)[0].load(),$(TX_Video.content)[0].play()}catch(e){TX_Video.MUTE(),$(TX_Video.content)[0].load(),$(TX_Video.content)[0].play()}TX_Video.STATUS._100=!1},START:function(e){$(TX_Video.btn_play).css({display:"none",backgroundImage:"url("+TX_Video.ASSETS[0][1]+")",backgroundColor:"transparent"})},PROGRESS:function(e){let o=e.currentTarget.currentTime/e.currentTarget.duration;!TX_Video.STATUS._0&&e.currentTarget.currentTime>=.01?(TX_Video.STATUS._0=!0,$(TX_Video.player).css("opacity",1),$(TX_Video.container).css({backgroundImage:"none"}),TX_Video.SOUND_DISABLED||TX_Var.END||TX_Video.UNMUTE(),$(TX_Video.content)[0].muted&&$(TX_Video.btn_unmute).show(),TX_Video.focus_interval=setInterval(TX_Video.INTERVAL,1e3)):!TX_Video.STATUS._25&&o>=.25?TX_Video.STATUS._25=!0:!TX_Video.STATUS._50&&o>=.5?TX_Video.STATUS._50=!0:!TX_Video.STATUS._75&&o>=.75&&(TX_Video.STATUS._75=!0)},END:function(e){TX_Video.STATUS._100=!0,$(TX_Video.container).css({display:"none",backgroundImage:"url("+TX_Video.CONFIG[TX_Video.CURRENT].endscreen+")"}),$(TX_Video.btn_play).css({display:"block",backgroundImage:"url("+TX_Video.ASSETS[1][1]+")",backgroundColor:"rgba(0,0,0,0.4)"}),TX_Video.DESTROY(),TX_Video.CONFIG[TX_Video.CURRENT].is_replay=!0,1===TX_Var.videoplayed?TX_Creative.STEP_3():TX_Creative.STEP_5(),TX_Audio.UNMUTE(TX_Audio.SND_BGM)},DESTROY:function(e){clearInterval(TX_Video.focus_interval),$(TX_Video.player).css("opacity",0),$(TX_Video.btn_unmute).hide(),$(TX_Video.content).off("play"),$(TX_Video.content).off("ended"),$(TX_Video.content).off("timeupdate"),TX_Video.STATUS._0=!1,TX_Video.STATUS._25=!1,TX_Video.STATUS._50=!1,TX_Video.STATUS._75=!1},PLAY:function(e){$(TX_Video.btn_play).hide(),$(TX_Video.content)[0].muted&&TX_Video.UNMUTE(),TX_Video.STATUS._100?TX_Video.LOAD(TX_Video.CURRENT):$(TX_Video.content)[0].play()},PAUSE:function(e){$(TX_Video.btn_play).show(),$(TX_Video.content)[0].pause()},UNMUTE:function(){$(TX_Video.btn_unmute).hide(),$(TX_Video.content)[0].muted=!1,$(TX_Video.content)[0].volume=1},MUTE:function(){$(TX_Video.content)[0].muted=!0,$(TX_Video.content)[0].volume=0},MINIMIZE:function(e,o,t){gsap.to(TX_Video.container,.2,{z:.001,x:e,y:o,scale:t,ease:"none"}),gsap.to(TX_Video.btn_vid,.2,{z:.001,scale:2,ease:"none"})},MAXIMIZE:function(){gsap.to(TX_Video.container,.2,{z:0,x:0,y:0,scale:1,ease:"none"}),gsap.to(TX_Video.btn_vid,.2,{z:.001,scale:1,ease:"none"})},SETUP:function(){TX_Video.container="#vid_container",TX_Video.player="#vid_player",TX_Video.content="#vid_content",TX_Video.btn_unmute="#vid_unmute",TX_Video.btn_play="#vid_play",TX_Video.btn_vid="#vid_container .btn_vid";let e="<div id='vid_container'></div>",o="<div id='vid_player'></div>",t="<video id='vid_content' preload='none' muted playsinline webkit-playsinline></video>",n="<div id='vid_unmute' class='btn_vid'></div>",i="<div id='vid_play' class='btn_vid'></div>";$(TX_Var.container).append(e),$(TX_Video.container).append(o),$(TX_Video.container).append(n),$(TX_Video.container).append(i),$(TX_Video.player).append(t),$(TX_Video.container).css({display:"none",left:TX_Video.STYLE.left,top:TX_Video.STYLE.top,width:TX_Video.STYLE.width,height:TX_Video.STYLE.height,backgroundColor:"transparent",backgroundSize:"cover",backgroundRepeat:"no-repeat",overflow:"hidden"}),$(TX_Video.player).css({pointerEvents:"none",left:"0px",top:"0px",width:"100%",height:"100%",opacity:0}),$(TX_Video.content).css({width:"100%",height:"100%"}),$(TX_Video.btn_vid).css({display:"none",left:"0px",top:"0px",width:"100%",height:"100%",backgroundRepeat:"no-repeat",backgroundPosition:"center"});for(let e=0;e<TX_Video.ASSETS.length;e++)$(TX_Video.ASSETS[e][0]).css("background-image","url("+TX_Video.ASSETS[e][1]+")");if(TX_Video.STYLE.center&&$(TX_Video.container).addClass("center"),!TX_Video.CONFIG[0].source){TX_Video.SOUND_DISABLED=!0;for(let e=0;e<TX_Video.CONFIG.length;e++)TX_Video.CONFIG[e].is_replay=!1}TX_Var.desktop?$(TX_Video.btn_vid).css("cursor","pointer"):$(TX_Video.btn_unmute).css({backgroundImage:"url("+TX_Video.ASSETS[3][1]+")"}),TX_Video.SOUND_DISABLED||($(TX_Video.content)[0].removeAttribute("muted"),TX_Video.UNMUTE()),$(TX_Video.btn_unmute).on("click",TX_Video.UNMUTE),$(TX_Video.btn_play).on("click",TX_Video.PLAY)},INTERVAL:function(){$(TX_Video.content)[0].paused?($(TX_Video.btn_play).show(),$(TX_Video.btn_unmute).hide()):($(TX_Video.btn_play).hide(),$(TX_Video.content)[0].muted?$(TX_Video.btn_unmute).show():$(TX_Video.btn_unmute).hide())},SOUND_DISABLED:!1,STATUS:{_0:!1,_25:!1,_50:!1,_75:!1,_100:!1}},TX_Scratch={IMAGE:["src/can_left.png","src/can_right.png"],ID:["can_fiesta","can_rosa"],CAN:["#can_left","#can_right"],INIT:function(e){function o(e,o){return Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2))}function t(e,o){return Math.atan2(o.x-e.x,o.y-e.y)}function n(e){const o=document.getElementById(TX_Scratch.ID[d]),t=o.getContext("2d");t.canvas.willReadFrequently=!0;for(var n=t.getImageData(0,0,X,l),i=n.data,a=i.length,r=a/e,_=0,T=_=0;T<a;T+=e)0===parseInt(i[T])&&_++;return Math.round(_/r*100)}function i(e){let o,t,n;return o=$(TX_Scratch.CAN[d]).offset(),t=o.left,n=o.top,TX_Var.desktop?(mx=(e.pageX-t)/TX_Var.stageScale,my=(e.pageY-n)/TX_Var.stageScale):(mx=(e.touches[0].pageX-t)/TX_Var.stageScale,my=(e.touches[0].pageY-n)/TX_Var.stageScale),{x:mx,y:my}}function a(e){e=e||0,e>85&&(u.parentNode.removeChild(u),0===TX_Var.videoplayed?TX_Creative.STEP_2(d):TX_Creative.STEP_4(d),setTimeout(()=>$(TX_Scratch.CAN[d]+" .can_white").css({opacity:1}),1e3),TX_Var.desktop?(u.removeEventListener("mousedown",r,!1),u.removeEventListener("mousemove",_,!1),document.removeEventListener("mouseup",T,!1)):(u.removeEventListener("touchstart",r,!1),u.removeEventListener("touchmove",_,!1),document.removeEventListener("touchend",T,!1)))}function r(e){s=!0,c=i(e),TX_Var.idle&&TX_Creative.stop_idle()}function _(e){if(s){e.preventDefault();for(var r,_,T=i(e),d=o(c,T),u=t(c,T),X=0;X<d;X++)r=c.x+Math.sin(u)*X-25,_=c.y+Math.cos(u)*X-25,p.globalCompositeOperation="destination-out",p.drawImage(V,r,_);c=T,a(n(1)),TX_Var.desktop||TX_Cursor.TOUCH(e),TX_Audio.SCRATCHING()}}function T(e){s=!1,TX_Audio.MUTE(TX_Audio.SND_SCRATCH)}var c,d=e,s=!1,u=document.getElementById(TX_Scratch.ID[d]),X=u.width,l=u.height,p=u.getContext("2d"),S=new Image,V=new Image;S.crossOrigin="Anonymous",V.crossOrigin="Anonymous",S.src=TX_Scratch.IMAGE[d],S.onload=function(){$(TX_Scratch.CAN[d]+" .can_black").css({opacity:0}),$(TX_Scratch.CAN[d]+" .can_reveal").css({opacity:1}),$("#"+TX_Scratch.ID[d]).css({transform:"translateZ(0)"}),p.drawImage(S,0,0),TX_Var.desktop?(u.addEventListener("mousedown",r,!1),u.addEventListener("mousemove",_,!1),document.addEventListener("mouseup",T,!1)):(u.addEventListener("touchstart",r,!1),u.addEventListener("touchmove",_,!1),document.addEventListener("touchend",T,!1))},V.src="src/brush.png"}},TX_Cursor={IMAGE:"src/img_cursor.png",canvasHolder:"#canvasHolder",width:81,height:81,image:new Image,INIT:function(){let e=document.getElementById("cursorHolder");TX_Cursor.ctx=e.getContext("2d"),TX_Cursor.image.crossOrigin="Anonymous",TX_Cursor.image.src=TX_Cursor.IMAGE,TX_API.IS_BROWSER.Explorer()&&$(TX_Var.main_panel).css({cursor:"url(ie_cursor.cur), auto"}),TX_Var.desktop&&$(TX_Var.main_panel).on("mousemove",TX_Cursor.MOUSE)},MOUSE:function(e){TX_Cursor.MOVE(e.pageX,e.pageY)},TOUCH:function(e){TX_Cursor.MOVE(e.touches[0].pageX,e.touches[0].pageY)},MOVE:function(e,o){let t=$(TX_Cursor.canvasHolder).offset(),n=t.left,i=t.top,a=(e-n)/TX_Var.stageScale,r=(o-i)/TX_Var.stageScale;TX_Cursor.REMOVE(),TX_Cursor.ctx.drawImage(TX_Cursor.image,a-20,r-60,TX_Cursor.width,TX_Cursor.height)},REMOVE:function(){TX_Cursor.ctx.clearRect(0,0,960,500)}},TX_Var={desktop:!("ontouchstart"in document.documentElement),stageScale:1,isButtonReady:!0,container:"#container",button:".button",zero:0},TX_Loader={IMAGE:function(e){for(let o=0;o<e.length;o++){let t=e[o][1];$("<img />").attr("src",t).on("load",TX_Loader.UPDATE_ASSETS)}},JS:function(e){for(let o=0;o<e.length;o++){let t=e[o];$.getScript(t,TX_Loader.UPDATE_ASSETS)}},UPDATE_ASSETS:function(){TX_Loader.LOADED_ASSETS+=1,TX_Loader.LOADED_ASSETS==TX_Loader.TOTAL_ASSETS&&TX_Loader.COMPLETE()},COMPLETE:function(){for(let e=0;e<TX_Asset.INIT_IMAGES.length;e++)$(TX_Asset.INIT_IMAGES[e][0]).css("background-image","url("+TX_Asset.INIT_IMAGES[e][1]+")");$(TX_Var.button).on("click",TX_Button.MOUSECLICK),TX_Creative.INIT(),TX_API.AUTOSCALE()},TOTAL_ASSETS:TX_Asset.INIT_IMAGES.length+TX_Asset.INIT_JS.length,LOADED_ASSETS:0},TX_API={CLICK_DELAY:function(e){TX_Var.isButtonReady=!1,setTimeout(()=>TX_Var.isButtonReady=!0,1e3*e)},AUTOSCALE:function(){function e(){var e=$("#container").css("transform");if("none"!=e)try{var o=e.split("(")[1];o=o.split(")")[0],o=o.split(",");var t=o[0],n=o[1];TX_Var.stageScale=Math.sqrt(t*t+n*n)}catch(e){TX_Var.stageScale=1}else TX_Var.stageScale=1}$(window).resize(e),e()},IS_BROWSER:{Chrome:function(){return!!navigator.userAgent.match(/Chrome/i)},Firefox:function(){return!!navigator.userAgent.match(/Firefox/i)},Safari:function(){return!(!navigator.userAgent.match(/Safari/i)||TX_API.IS_BROWSER.Chrome())},IE10:function(){return!!navigator.userAgent.match(/MSIE/i)},IE11:function(){return!!navigator.userAgent.match(/Trident/i)},Edge:function(){return!!navigator.userAgent.match(/Edge/i)},Kik:function(){return!!navigator.userAgent.match(/Kik/i)},Explorer:function(){return TX_API.IS_BROWSER.IE10()||TX_API.IS_BROWSER.IE11()||TX_API.IS_BROWSER.Edge()}}};TX_Audio.INIT();