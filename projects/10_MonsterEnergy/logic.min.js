(function(){var e={INIT_IMAGES:[["#background","src/background.jpg"],["#logo","src/logo.png"],["#txt_tryitnow","src/txt_tryitnow.png"],["#txt_copy","src/txt_copy.png"],[".can_black","src/can_black.png"],[".can_white","src/can_white.png"],[".can_reveal","src/can_reveal.png"]],INIT_JS:["https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"]},n={MOUSECLICK:function(e){if(r.isButtonReady)switch(u.CLICK_DELAY(.2),this.id){case"btn_tryitnow":window.open("https://www.monsterenergy.com/","_blank")}}},t={INIT:function(){r.canvasHolder="#container #canvasHolder",r.can_container="#container #can_container",r.main_panel="#container #main_panel",r.can="#container #js-canvas",r.top_panel="#container #top_panel",r.can_white="#container .bg_cans .can_white",r.btn_tryitnow="#container #btn_tryitnow",r.txt_tryitnow="#container #txt_tryitnow",r.bg_tryitnow="#container #bg_tryitnow",r.videoplayed=0,r.idletimer=null,r.idle=!0,r.scratch=0,r.pulse_cta=gsap.timeline({repeat:-1,repeatDelay:6,overwrite:!0}),r.pulse_delay=null,t.STEP_1()},STEP_1:function(){i.INIT(0),i.INIT(1),c.INIT(),a.INIT(),t.init_pulse_cta(),r.idletimer=setTimeout(function(){gsap.fromTo(r.can_white,.6,{alpha:0},{alpha:1,repeat:-1,yoyo:!0,ease:"none"})},7e3)},STEP_2:function(e){a.LOAD(e),r.videoplayed=1},STEP_3:function(){},STEP_4:function(e){a.LOAD(e),r.videoplayed=2},STEP_5:function(){$(r.canvasHolder).hide(),$(r.main_panel).css({cursor:"auto"})},stop_idle:function(){r.idle=!1,clearTimeout(r.idletimer),gsap.to(r.can_white,.2,{alpha:0,repeat:0,yoyo:!1})},init_pulse_cta:function(e){r.pulse_cta.fromTo(r.bg_tryitnow,.5,{z:.01,scale:1,alpha:1},{z:.01,scaleX:1.15,scaleY:1.5,alpha:0},"pulse").to(r.txt_tryitnow,.2,{z:.01,scale:1.08,repeat:1,yoyo:!0},"pulse"),$(r.btn_tryitnow).on("mouseenter",function(){clearTimeout(r.pulse_delay),r.pulse_cta.pause(),gsap.to(r.bg_tryitnow,.2,{z:.01,scaleX:1.15,scaleY:1.5,alpha:0,overwrite:!0}),gsap.to(r.txt_tryitnow,.1,{z:.01,scale:1,overwrite:!0})}),$(r.btn_tryitnow).on("mouseleave",function(){r.pulse_delay=setTimeout(function(){r.pulse_cta.play(0)},6e3)})}},o={ASSETS:[["SND_BGM",{src:"src/audio/bgm.mp3",volume:.5}],["SND_SCRATCH",{src:"src/audio/sfx_scratch.mp3",loop:!0,volume:0}]],ACTIVE_BUTTON:!0,INIT:function(e){if(img_audio=".img_audio",btn_audio="#btn_audio",$.getScript("https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js",o.READY),o.ACTIVE_BUTTON){let e="<div id='btn_audio' class='button'><div class='img_audio center'></div></div>";$("#container").append(e),$(img_audio).css({width:"30px",height:"30px",background:"url(src/spr_audio.png) no-repeat",transform:"scale(0.92) translateZ(0) scaleZ(2)"}),$(btn_audio).css({right:"8px",top:"17px",width:"45px",height:"45px"})}$(btn_audio).on("click",o.MOUSECLICK),r.desktop&&$(btn_audio).hover(o.MOUSEOVER,o.MOUSEOUT)},READY:function(n){for(let e=0;e<o.ASSETS.length;e++)o.ASSETS[e][1].preload=!0,o[o.ASSETS[e][0]]=new Howl(o.ASSETS[e][1]);o.PLAY(o.SND_BGM),o.PLAY(o.SND_SCRATCH),s.IMAGE(e.INIT_IMAGES),s.JS(e.INIT_JS)},MOUSECLICK:function(e){o.ACTIVE?(o.ACTIVE=!1,o.VOLUME_OFF()):(o.ACTIVE=!0,o.VOLUME_ON())},MOUSEOVER:function(e){$(img_audio).css("transform","scale(1) translateZ(0) scaleZ(2)")},MOUSEOUT:function(e){$(img_audio).css("transform","scale(0.92) translateZ(0) scaleZ(2)")},PLAY:function(e){e.playing()?o.SEEK(e,0):e.play()},PAUSE:function(e){e.pause()},STOP:function(e){e.stop()},MUTE:function(e){e.volume(0)},UNMUTE:function(e){e.volume(1)},SEEK:function(e,n){e.seek(n)},VOLUME_ON:function(){Howler.volume(1),$(".img_audio").css("background-position-y","0px")},VOLUME_OFF:function(){Howler.volume(0),$(".img_audio").css("background-position-y","-40px")},END:function(e){Howler.unload()},SCRATCHING:function(e){o.UNMUTE(o.SND_SCRATCH),r.endScratch=setTimeout(function(){o.MUTE(o.SND_SCRATCH)},500)},ACTIVE:!0},a={ASSETS:[["#vid_play","src/ico_play.png"],["#vid_replay","src/ico_replay.png"],["#vid_unmute","src/click_for_sound.png"],["#vid_unmute_mob","src/tap_for_sound.png"]],CONFIG:[{source:"src/video/Fiesta_Video.mp4",trackname:"Fiesta Video",preview:"src/video_prev0.jpg",endscreen:"src/video_prev0.jpg"},{source:"src/video/Rosa_Video.mp4",trackname:"Rosa Video",preview:"src/video_prev1.jpg",endscreen:"src/video_prev1.jpg"}],STYLE:{left:0,top:0,width:960,height:540,center:!0},INIT:function(e){a.SETUP(),e>=0&&e<=a.CONFIG.length&&($("<img />").attr("src",a.CONFIG[e].preview).load(a.LOAD(e)),a.AUTOPLAY=!0)},LOAD:function(e){a.CURRENT=e,a.DESTROY(),$(a.container).css({backgroundImage:"url("+a.CONFIG[a.CURRENT].preview+")",display:"block"}),$(a.content).on("play",a.START),$(a.content).on("ended",a.END),$(a.content).on("timeupdate",a.PROGRESS),o.MUTE(o.SND_BGM),$(a.content)[0].src=a.CONFIG[a.CURRENT].source,$(a.content)[0].load(),$(a.content)[0].play(),a.STATUS._100=!1},START:function(e){$(a.btn_play).css({display:"none",backgroundImage:"url("+a.ASSETS[0][1]+")",backgroundColor:"transparent"})},PROGRESS:function(e){let n=e.currentTarget.currentTime/e.currentTarget.duration;!a.STATUS._0&&e.currentTarget.currentTime>=.01?(a.STATUS._0=!0,$(a.player).css("opacity",1),$(a.container).css({backgroundImage:"none"}),a.SOUND_DISABLED||r.END||a.UNMUTE(),$(a.content)[0].muted&&$(a.btn_unmute).show(),a.focus_interval=setInterval(a.INTERVAL,1e3)):!a.STATUS._25&&n>=.25?a.STATUS._25=!0:!a.STATUS._50&&n>=.5?a.STATUS._50=!0:!a.STATUS._75&&n>=.75&&(a.STATUS._75=!0)},END:function(e){a.STATUS._100=!0,$(a.container).css({display:"none",backgroundImage:"url("+a.CONFIG[a.CURRENT].endscreen+")"}),$(a.btn_play).css({display:"block",backgroundImage:"url("+a.ASSETS[1][1]+")",backgroundColor:"rgba(0,0,0,0.4)"}),a.DESTROY(),a.CONFIG[a.CURRENT].is_replay=!0,1===r.videoplayed?t.STEP_3():t.STEP_5(),o.UNMUTE(o.SND_BGM)},DESTROY:function(e){clearInterval(a.focus_interval),$(a.player).css("opacity",0),$(a.btn_unmute).hide(),$(a.content).off("play"),$(a.content).off("ended"),$(a.content).off("timeupdate"),a.STATUS._0=!1,a.STATUS._25=!1,a.STATUS._50=!1,a.STATUS._75=!1},PLAY:function(e){$(a.btn_play).hide(),$(a.content)[0].muted&&a.UNMUTE(),a.STATUS._100?a.LOAD(a.CURRENT):$(a.content)[0].play()},PAUSE:function(e){$(a.btn_play).show(),$(a.content)[0].pause()},UNMUTE:function(){$(a.btn_unmute).hide(),$(a.content)[0].muted=!1,$(a.content)[0].volume=1},MUTE:function(){$(a.content)[0].muted=!0,$(a.content)[0].volume=0},MINIMIZE:function(e,n,t){gsap.to(a.container,.2,{z:.001,x:e,y:n,scale:t,ease:"none"}),gsap.to(a.btn_vid,.2,{z:.001,scale:2,ease:"none"})},MAXIMIZE:function(){gsap.to(a.container,.2,{z:0,x:0,y:0,scale:1,ease:"none"}),gsap.to(a.btn_vid,.2,{z:.001,scale:1,ease:"none"})},SETUP:function(){a.container="#vid_container",a.player="#vid_player",a.content="#vid_content",a.btn_unmute="#vid_unmute",a.btn_play="#vid_play",a.btn_vid="#vid_container .btn_vid";let e="<div id='vid_container'></div>",n="<div id='vid_player'></div>",t="<video id='vid_content' preload='none' muted playsinline webkit-playsinline></video>",o="<div id='vid_unmute' class='btn_vid'></div>",i="<div id='vid_play' class='btn_vid'></div>";$(r.container).append(e),$(a.container).append(n),$(a.container).append(o),$(a.container).append(i),$(a.player).append(t),$(a.container).css({display:"none",left:a.STYLE.left,top:a.STYLE.top,width:a.STYLE.width,height:a.STYLE.height,backgroundColor:"transparent",backgroundSize:"cover",backgroundRepeat:"no-repeat",overflow:"hidden"}),$(a.player).css({pointerEvents:"none",left:"0px",top:"0px",width:"100%",height:"100%",opacity:0}),$(a.content).css({width:"100%",height:"100%"}),$(a.btn_vid).css({display:"none",left:"0px",top:"0px",width:"100%",height:"100%",backgroundRepeat:"no-repeat",backgroundPosition:"center"});for(let e=0;e<a.ASSETS.length;e++)$(a.ASSETS[e][0]).css("background-image","url("+a.ASSETS[e][1]+")");if(a.STYLE.center&&$(a.container).addClass("center"),!a.CONFIG[0].source){a.SOUND_DISABLED=!0;for(let e=0;e<a.CONFIG.length;e++)a.CONFIG[e].is_replay=!1}r.desktop?$(a.btn_vid).css("cursor","pointer"):$(a.btn_unmute).css({backgroundImage:"url("+a.ASSETS[3][1]+")"}),a.SOUND_DISABLED||($(a.content)[0].removeAttribute("muted"),a.UNMUTE()),$(a.btn_unmute).on("click",a.UNMUTE),$(a.btn_play).on("click",a.PLAY)},INTERVAL:function(){$(a.content)[0].paused?($(a.btn_play).show(),$(a.btn_unmute).hide()):($(a.btn_play).hide(),$(a.content)[0].muted?$(a.btn_unmute).show():$(a.btn_unmute).hide())},SOUND_DISABLED:!1,STATUS:{_0:!1,_25:!1,_50:!1,_75:!1,_100:!1}},i={IMAGE:["src/can_left.png","src/can_right.png"],ID:["can_fiesta","can_rosa"],CAN:["#can_left","#can_right"],INIT:function(e){function n(e,n){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}function a(e,n){return Math.atan2(n.x-e.x,n.y-e.y)}function s(e){for(var n=v.getImageData(0,0,m,f),t=n.data,o=t.length,a=o/e,i=0,c=i=0;c<o;c+=e)0===parseInt(t[c])&&i++;return Math.round(i/a*100)}function u(e){let n,t,o;return n=$(i.CAN[E]).offset(),t=n.left,o=n.top,r.desktop?(mx=(e.pageX-t)/r.stageScale,my=(e.pageY-o)/r.stageScale):(mx=(e.touches[0].pageX-t)/r.stageScale,my=(e.touches[0].pageY-o)/r.stageScale),{x:mx,y:my}}function l(e){e=e||0,e>90&&(g.parentNode.removeChild(g),0===r.videoplayed?t.STEP_2(E):t.STEP_4(E),setTimeout(()=>$(i.CAN[E]+" .can_white").css({opacity:1}),1e3),r.desktop?(g.removeEventListener("mousedown",d,!1),g.removeEventListener("mousemove",p,!1),document.removeEventListener("mouseup",_,!1)):(g.removeEventListener("touchstart",d,!1),g.removeEventListener("touchmove",p,!1),document.removeEventListener("touchend",_,!1)))}function d(e){T=!0,S=u(e),r.idle&&t.stop_idle()}function p(e){if(T){e.preventDefault();for(var t,i,d=u(e),p=n(S,d),_=a(S,d),E=0;E<p;E++)t=S.x+Math.sin(_)*E-25,i=S.y+Math.cos(_)*E-25,v.globalCompositeOperation="destination-out",v.drawImage(A,t,i);S=d,l(s(1)),r.desktop||c.TOUCH(e),o.SCRATCHING()}}function _(e){T=!1,o.MUTE(o.SND_SCRATCH)}var S,E=e,T=!1,g=document.getElementById(i.ID[E]),m=g.width,f=g.height,v=g.getContext("2d"),I=new Image,A=new Image;I.crossOrigin="Anonymous",A.crossOrigin="Anonymous",I.src=i.IMAGE[E],I.onload=function(){$(i.CAN[E]+" .can_black").css({opacity:0}),$(i.CAN[E]+" .can_reveal").css({opacity:1}),$("#"+i.ID[E]).css({transform:"translateZ(0)"}),v.drawImage(I,0,0),r.desktop?(g.addEventListener("mousedown",d,!1),g.addEventListener("mousemove",p,!1),document.addEventListener("mouseup",_,!1)):(g.addEventListener("touchstart",d,!1),g.addEventListener("touchmove",p,!1),document.addEventListener("touchend",_,!1))},A.src="src/brush.png"}},c={IMAGE:"src/img_cursor.png",canvasHolder:"#canvasHolder",width:81,height:81,image:new Image,INIT:function(){let e=document.getElementById("cursorHolder");c.ctx=e.getContext("2d"),c.image.crossOrigin="Anonymous",c.image.src=c.IMAGE,u.IS_BROWSER.Explorer()&&$(r.main_panel).css({cursor:"url(ie_cursor.cur), auto"}),r.desktop&&$(r.main_panel).on("mousemove",c.MOUSE)},MOUSE:function(e){c.MOVE(e.pageX,e.pageY)},TOUCH:function(e){c.MOVE(e.touches[0].pageX,e.touches[0].pageY)},MOVE:function(e,n){let t=$(c.canvasHolder).offset(),o=t.left,a=t.top,i=(e-o)/r.stageScale,s=(n-a)/r.stageScale;c.REMOVE(),c.ctx.drawImage(c.image,i-20,s-60,c.width,c.height)},REMOVE:function(){c.ctx.clearRect(0,0,960,500)}},r={desktop:!("ontouchstart"in document.documentElement),stageScale:1,isButtonReady:!0,container:"#container",button:".button",zero:0},s={IMAGE:function(e){for(let n=0;n<e.length;n++){let t=e[n][1];$("<img />").attr("src",t).on("load",s.UPDATE_ASSETS)}},JS:function(e){for(let n=0;n<e.length;n++){let t=e[n];$.getScript(t,s.UPDATE_ASSETS)}},UPDATE_ASSETS:function(){s.LOADED_ASSETS+=1,s.LOADED_ASSETS==s.TOTAL_ASSETS&&s.COMPLETE()},COMPLETE:function(){for(let n=0;n<e.INIT_IMAGES.length;n++)$(e.INIT_IMAGES[n][0]).css("background-image","url("+e.INIT_IMAGES[n][1]+")");$(r.button).on("click",n.MOUSECLICK),t.INIT(),u.AUTOSCALE()},TOTAL_ASSETS:e.INIT_IMAGES.length+e.INIT_JS.length,LOADED_ASSETS:0},u={CLICK_DELAY:function(e){r.isButtonReady=!1,setTimeout(()=>r.isButtonReady=!0,1e3*e)},AUTOSCALE:function(){function e(){var e=$("#container").css("transform");if("none"!=e)try{var n=e.split("(")[1];n=n.split(")")[0],n=n.split(",");var t=n[0],o=n[1];r.stageScale=Math.sqrt(t*t+o*o)}catch(e){r.stageScale=1}else r.stageScale=1}$(window).resize(e),e()},IS_BROWSER:{Chrome:function(){return!!navigator.userAgent.match(/Chrome/i)},Firefox:function(){return!!navigator.userAgent.match(/Firefox/i)},Safari:function(){return!(!navigator.userAgent.match(/Safari/i)||u.IS_BROWSER.Chrome())},IE10:function(){return!!navigator.userAgent.match(/MSIE/i)},IE11:function(){return!!navigator.userAgent.match(/Trident/i)},Edge:function(){return!!navigator.userAgent.match(/Edge/i)},Kik:function(){return!!navigator.userAgent.match(/Kik/i)},Explorer:function(){return u.IS_BROWSER.IE10()||u.IS_BROWSER.IE11()||u.IS_BROWSER.Edge()}}};o.INIT()})();